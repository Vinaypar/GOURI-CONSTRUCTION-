(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-3sfile"],{"1DZO":function(e,t,r){"use strict";r.r(t);var o=r("wAGM"),i=r("GtFt"),n=r("3twC"),s=r("D59/"),c=r("oQg0"),a=r("cDcd");const p=Object(s.a)("pp-comp",()=>Promise.all([r.e("pro-3sfactfile"),r.e("sug-univ"),r.e("pro-3s-topicanswerdata~pro-haukfiles~pro-kmfile~pro-kmpeople~pro-kmsite~pro-kmtopic~sug-person-answer"),r.e("pro-3sfefile"),r.e("cmd-opentopiccard"),r.e("pro-3sepa"),r.e("cpl-clear"),r.e("cpl-mag-fit"),r.e("pol-eager"),r.e("vendors~ans-people~cmd-copyfileurl~cmd-deletepqh~cmd-favouritefile~cmd-openpeoplecentricsb~cmd-share~e286c88f"),r.e("cpl-exit"),r.e("warmup"),r.e("stream"),r.e("cpl-filterbtn"),r.e("sug-pplkey"),r.e("aria"),r.e("vendors~ans-people~cpl-answerproviderhost~cpl-commanding~cpl-filesearchsubmitsearchsuggestion~cpl-no~d98382b4"),r.e("oneds"),r.e("pro-3stext"),r.e("ans-people"),r.e("pro-kmfile"),r.e("sug-horizontalapp"),r.e("pro-bingtag"),r.e("vendors~cpl-commanding~cpl-teachingmoments~debug~fb-comp~mp-comp~pp-comp~sc-comp~sug-ext-filesugqa~s~4f9740f2"),r.e("cpl-submit"),r.e("cpl-hidemag"),r.e("vendors~cpl-teachingmoments~debug~fb-comp~mp-comp~pp-comp~sc-comp~sug-ext-filesugqa~sug-pplkey~tp-comp"),r.e("pro-3spqh"),r.e("cmd-copyemail"),r.e("cmd-mailto"),r.e("tp-comp"),r.e("cmd-copyanswer~cmd-copybookmarkurl~cmd-copyemail~cmd-copyfileurl~cmd-copysiteurl~cmd-deletepqh~cmd-d~15228af6"),r.e("ans-people~cmd-openpeoplecentricsb~cpl-answerproviderhost~cpl-host~cpl-invoker~cpl-no-submit~extract~05b753b7"),r.e("mp-comp"),r.e("pro-3sbm"),r.e("ans-people~cmd-openpeoplecentricsb~cpl-answerproviderhost~extracted-people-answers-email~extracted-p~95ccb448"),r.e("pro-app"),r.e("ans-people~cmd-openpeoplecentricsb~cpl-answerproviderhost~extracted-people-answers-email~extracted-p~3dfbcab3"),r.e("fb-comp"),r.e("cpl-answerproviderhost~cpl-host~cpl-invoker~cpl-no-submit~extracted-people-answers-email~extracted-p~3485bd1c"),r.e("cpl-answerproviderhost~cpl-exit~cpl-host~cpl-invoker~cpl-no-submit~pp-comp~stream"),r.e("pp-comp")]).then(r.bind(null,"Elzn")),e=>e.default),l=Object(c.a)(p);class d extends a.Component{constructor(e){var t,r,o;super(e),this.state={personaPillData:(null===(o=null===(r=null===(t=this.props.instrumenter)||void 0===t?void 0:t.props)||void 0===r?void 0:r.scenarioContext)||void 0===o?void 0:o.personScope)||{}}}componentDidMount(){var e;const t=null===(e=this.props.instrumenter)||void 0===e?void 0:e.register(e=>{var t;e.hostAppInfo&&("person"!==e.hostAppInfo.scopeId&&"personAnswer"!==e.hostAppInfo.scopeId||!(null===(t=e.scenarioContext)||void 0===t?void 0:t.personScope)?this.setState({personaPillData:{}}):this.setState({personaPillData:e.scenarioContext.personScope}))});this.setState({instrumenterId:t})}render(){return this.state.personaPillData&&this.state.personaPillData.userPrincipalName?a.createElement(l,Object.assign({},this.props,{personaPillData:this.state.personaPillData||{}})):null}}var u=Object(n.a)("startButton","SearchBoxPersonaPill")(e=>a.createElement(d,Object.assign({},e)));t.default=Object(o.a)(i.o)(u)},"3Ir8":function(e,t,r){"use strict";r.r(t);var o=r("9YZs"),i=r("9LXr"),n=r("UZl3"),s=r("GPGK"),c=Object(s.a)({id:"CopyLink",entityType:"File",parameters:[{name:"file",entity:"File",isRequired:!0,validate:function(e){var t;return e.id.startsWith("SPO_")&&!!Object(i.a)((null===(t=e.customProps)||void 0===t?void 0:t.fileUrl)||e.id)}}],execute:function(e){var t=e.file.value,r=t.customProps,i=t.id;return Object(o.a)(i,(null==r?void 0:r.fileUrl)||i,!0)},additionalProps:{tooltip:n.a,icon:{iconName:"Link"}}});t.default=c},H3jn:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var o=r("UlRC"),i=r("ABrm"),n=r("Ta5s"),s=r("QxCF"),c=r("oo+0");function a(e,t,r){if(!e)throw new Error("Search box configuration must be specified.");const{streamPolicy:a,groups:l}=e,d=l.map(o=>new c.a(e,o,t).createStream(r)),u=d.map(e=>e.slice(0,e.length-1)),m=o.Observable.fromArray(Object(i.a)(d.map(e=>Object(n.a)(e)))).selectMany(e=>e.catchException(e=>o.Observable.returnValue(e))).toArray().where(e=>!!e.length).select(e=>{throw Object(s.a)(new Error("Suggestion stream error. See inner errors for details."),{innerErrors:e})});return(a(l,p,u,o,{searchText:r})||o.Observable.empty()).concat(m)}const p=e=>e.id},WMEh:function(e,t,r){"use strict";function o(e){return function(t){var r=t.prefetchTimeSinceOrigin||performance.now.bind(performance),o=r();return n(0,o,t,e,r).catch((function(s){return i(s)?n(1,o,t,e,r).catch((function(e){return function(e,t,r){if(i(e)){var o=e;throw o.tokenAttemptCount=t,o.tokenFetchDuration=r,o}throw e}(e,2,r()-o)})):Promise.reject(s)}))}}function i(e){return!!e&&(401===e.status||0===e.status)}function n(e,t,r,o,i){if(!("token"in r)&&!("tokenProvider"in r))return Promise.reject(new Error("Token or token provider must be specified."));var n=-1;return"token"in r&&function(e){return!!e.token}(r)?o(r.token)(r).then((function(e){return{tokenAttemptCount:0,tokenFetchDuration:0,xhr:e}})):r.tokenProvider({attempt:e}).then((function(e){return n=i()-t,o(e)(r)})).then((function(t){return{tokenAttemptCount:e+1,tokenFetchDuration:n,xhr:t}}))}r.d(t,"a",(function(){return o}))},ksKV:function(e,t,r){"use strict";r.r(t);var o=r("n5ha"),i=r("i8tK"),n=r("GXij"),s=r("GPGK"),c=(Object(o.declareString)("search-dl.quickActions.managePQH.tooltip")),a=Object(s.a)({id:"ManagePQH",entityType:"Text",parameters:[{name:"text",entity:"Text",isRequired:!0,validate:function(e){var t;return!!(null===(t=e.customProps)||void 0===t?void 0:t.isHistory)}}],execute:function(){var e=Object(i.b)();return e?(Object(n.a)(e,"NewTab",window),Promise.resolve()):Promise.reject("No url configured for removePersonalQueryUrl")},additionalProps:{url:function(){return Object(i.b)()},icon:{iconName:"Settings"},tooltip:c}});t.default=a},"lzq+":function(e,t,r){"use strict";r.r(t),r.d(t,"KMSiteSuggestionEntity",(function(){return f})),r.d(t,"registration",(function(){return h}));var o=r("+zb2"),i=r("qArz"),n=r("UlRC"),s=r("rpSO"),c=r("KmCS"),a=r("F6lS"),p=r("AF84"),l=r("a7o/"),d=r("HTw2"),u=r("V34+"),m=r("lS1Q");const f="Site";let b=class{constructor(e,t){this.topicScope=e,this.context=t}getId(){return`KM${f}SuggestionProvider`}createStream(e){var t,r,o;const s=null===(t=this.context)||void 0===t?void 0:t.commanding.currentCommand.values[0].id;if(!s||!(null===(r=this.context)||void 0===r?void 0:r.instrumenter.props.serviceEnvInfo))return n.Observable.empty();const c=Object(d.a)(null===(o=this.context)||void 0===o?void 0:o.instrumenter.props.serviceEnvInfo);return Object(m.a)({topicId:s,environment:c,entity:f,filterSpec:u.b,searchText:e}).select(({Id:t,Title:r,Acronym:o,Color:n,Url:s})=>({entityType:"KM"+f,id:t,displayTexts:[{text:Object(l.c)([e],r),icon:{acronymIcon:{acronym:o,color:Object(i.a)(n,void 0,!0)},ariaLabel:Object(p.d)()}}],url:s}))}};b=Object(o.__decorate)([Object(o.__param)(0,Object(s.a)("topicScope")),Object(o.__param)(1,Object(s.a)("context"))],b),t.default=b;const h=Object(c.regs)(`${a.a}.${b.prototype.getId()}`,b)},"oo+0":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var o=r("UlRC"),i=r("mkze"),n=r("D7WJ"),s=r("nbvZ");class c{constructor(e,t,r){if(this.config=e,this.groupConfig=t,!t.providers)throw new Error("Search box suggestion type configuration must contain a list of providers.");if(this.providerInstances=t.providers.map(n=>Object(i.a)(n,Object.assign(Object.assign({},r),{config:e,groupConfig:t,rxjs:o}))),!this.providerInstances.every(e=>l(e.getId)&&l(e.createStream)))throw new Error("Suggestion providers must implement methods getId and createStream.")}createStream(e){const t=[],r=[],i=this.providerInstances,c=this.groupConfig.id;for(let p=0;p<i.length;p++)!function(i){try{r.push(i.createStream(e).select(e=>Object.assign(Object.assign({},e),{emitTime:Object(n.a)(),groupId:c,providerId:i.getId()})).catchException(e=>{var r;return s.a.DEBUG_SB_PROVIDER&&(null===(r=null===console||void 0===console?void 0:console.error)||void 0===r||r.call(console,"In provider:",i.getId(),e)),t.push(a(i.getId(),e)),o.Observable.empty()}))}catch(e){t.push(a(i.getId(),e))}}(i[p]);return r.push(o.Observable.defer(()=>t.length?o.Observable.throwException(p(c,t)):o.Observable.empty())),Object.freeze(r)}}const a=(e,t)=>{const r=new Error(`Error in suggestion provider "${e}". See inner error for details.`);return r.providerId=e,r.innerError=t,r},p=(e,t)=>{const r=new Error(`Error in suggestion provider group "${e}". See inner error for details.`);return r.providerGroupId=e,r.innerErrors=t,r};function l(e){return"function"==typeof e}},"uih/":function(e,t,r){"use strict";r.r(t),r.d(t,"registration",(function(){return g}));var o=r("+zb2"),i=r("rpSO"),n=r("KmCS"),s=r("F6lS"),c=r("POWj"),a=r("g+lP"),p=r("ohlq"),l=r("xo1z"),d=r("Xopu"),u=r("mGoP"),m=r("bs+K"),f=r("Q+QT"),b=r("qGDX"),h=r("q9uV");let v=class extends class{createStream(e){return Object(b.b)(this.fetcher,"File",{searchText:e,entityTypes:this.config?Object(h.b)(this.config,e):["File"],scenario:this.scenario,appOverride:this.appOverride,logicalSearchId:this.logicalId,conversationId:this.conversationId}).selectConcat(()=>this.personalUrl,(t,r)=>{var o;const{AccessUrl:i,Author:n,AuthorEmail:s,DateCreated:c,DateModified:a,DateAccessed:p,FileExtension:l,FileName:d,FileSourceType:b,FileType:h,ModifiedBy:v,ModifiedByDisplayName:g,PropertyHits:O,SourceTitle:y,logProps:j,originalLogicalSearchId:S,entityType:x,From:I,SharedDateTime:w,UserRelationshipType:P,SpoId:T,SPWebUrl:k,SpoUniqueId:D}=t,E=Object(m.b)(d),A=Object(u.b)(e,"FileName",E,O),_=Object(u.b)(e,null==O?void 0:O[0],Object(u.a)({createdDate:c,authorDisplayName:n||(null===(o=null==I?void 0:I.EmailAddress)||void 0===o?void 0:o.Name)||"",authorEmail:s||"",dateModified:a,modifiedByDisplayName:g,propertyHits:O,lastAccessedDate:p,fileType:h,fileSourceType:b,modifiedBy:v,fromObject:I,sharedDateTime:w,userRelationshipType:P}),O),C=Object(f.a)(t);return{logProps:j,id:T||i,searchText:e,title:A,url:i+"?web=1",fileExtension:l,fileSourceType:b,fileType:h,displayText:A,lastModifiedTime:a,lastModifiedBy:g,lastModifiedByAccountName:v,parentSiteTitle:y,secondaryDisplayText:_,sPWebUrl:k,uniqueId:D,originalLogicalSearchId:S,entityType:x,displayTextRaw:E,tidbitIconName:null==C?void 0:C.icon,customProps:{tidbitIconLabel:null==C?void 0:C.label}}})}}{constructor(e,t,r){super(),this.config=e,this.fetcher=t,this.conversation=r,this.scenario=Object(l.a)(Object(p.a)()),this.appOverride=Object(c.a)(),this.conversationId=this.conversation&&this.conversation.conversationId,this.logicalId=this.conversation&&this.conversation.getLogicalSearchId("sb"),this.personalUrl=Promise.resolve(Object(a.a)())}getId(){return"AutoSuggestFileSuggestionProvider"}};v=Object(o.__decorate)([Object(h.a)({entityType:"File"}),Object(o.__param)(0,Object(i.a)("config")),Object(o.__param)(1,Object(i.a)("fetcher")),Object(o.__param)(2,Object(i.a)("conversation"))],v);t.default=v;const g=Object(n.regs)(`${s.a}.${d.d}`,v)}}]);